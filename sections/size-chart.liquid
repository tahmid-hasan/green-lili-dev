<script src="{{ 'size-chart.js' | asset_url }}" defer></script>
{{ 'size-chart.css' |  asset_url | stylesheet_tag }}
{%- liquid
  assign title = section.settings.heading
-%}
<size-chart-drawer
  id="SizeChartDrawer"
  class="drawer drawer--right size-chart-drawer" shopify-design-mode hidden>
  <div class="fixed-overlay" aria-controls="SizeChartDrawer"></div>
  <div class="drawer__inner">
    <button class="drawer__close-btn z-1" aria-controls="SizeChartDrawer" type="button">
      {% render 'icon-close' %}
    </button>
    <div class="drawer__content flex flex-col h-full w-full">
      <tabs-component class="tabs tabs__nav-design-1">
        <div class="drawer__header search-drawer__header flex flex-col gap-5 items-start">
          <h2 class="drawer__heading h3 flex items-center">
            {{ title }}
          </h2>
          
          <motion-element
            class="tabs__header tabs__header--horizontal flex flex-col md:flex-row md:justify-between md:items-center items-start"
            data-motion="fade-up"
          >
            <div class="tabs__nav-wrap">
              <div class="tabs__nav" role="tablist">
                {%- for block in section.blocks -%}
                  <button
                    class="tabs__tab focus-inset"
                    role="tab"
                    id="{{ block.id }}"
                    {{ block.shopify_attributes }}
                  >
                    <span class="tabs__tab-name h4">{{ block.settings.title }}</span>
                  </button>
                {%- endfor -%}
              </div>
            </div>
          </motion-element>
        </div>
        <div class="v-scrollable drawer__body flex-grow">
          <div class="tabs__panel">
            {%- for block in section.blocks -%}
              {%- case block.type -%}
                {%- when 'size_details' -%}
                  {%- liquid
                    assign orientation = product.metafields.custom.orientation.value | first | downcase

                    assign size_chart_image = images['PORTRAIT-CANVAS-SIZES.webp']
                    if orientation == 'square'
                      assign size_chart_image = images['SQUARE-CANVAS-SIZES-SCALE.webp']
                    endif
                    assign size_chart_content = block.settings.page_portrait
                    
                    if orientation == 'portrait' or orientation == 'landscape'
                      if block.settings.portrait_image != blank
                        assign size_chart_image = block.settings.portrait_image
                      endif
                      if block.settings.page_portrait != blank
                        assign size_chart_content = block.settings.page_portrait
                      endif
                    elsif orientation == 'square'
                      if block.settings.square_image != blank
                        assign size_chart_image = block.settings.square_image
                      endif
                      if block.settings.page_square != blank
                        assign size_chart_content = block.settings.page_square
                      endif
                    endif

                    if block.settings.image != blank
                      assign size_chart_image = block.settings.image
                    endif

                    if block.settings.content != blank
                      assign size_chart_content = block.settings.content
                    endif
                  -%}
                <div
                  class="tabs__content"
                  id="tab-{{ block.id }}"
                  data-index="{{ forloop.index0 }}"
                  role="tabpanel"
                  {% unless forloop.first %}
                    hidden
                  {% endunless %}
                >
                  <div class="size-chart-drawer__image-wrapper">
                    <div class="gl-size-charts" id="gl-size-charts">
                      <div class="gl-size-chart-image">
                        {{ size_chart_image | image_url: width: 800 | image_tag }}
                      </div>
                      <div class="gl-size-chart-content">
                        {{- size_chart_content.content -}}
                      </div>
                    </div>
                  </div>
                </div>
                {%- when 'size_guide' -%}
                  <div
                    class="tabs__content"
                    id="tab-{{ block.id }}"
                    data-index="{{ forloop.index0 }}"
                    role="tabpanel"
                    {% unless forloop.first %}
                      hidden
                    {% endunless %}
                  >
                    <div class="size-chart">
                      {{ block.settings.content.content }}
                    </div>
                  </div>
              {%- endcase -%}
            {%- endfor -%}
          </div>
        </div>
      </tabs-component>
    </div>
  </div>
</size-chart-drawer>

{% comment %} <!-- ===== Canvas Size Charts ===== -->
<div class="gl-size-charts">

  <!-- Portrait / Landscape -->
  <div class="gl-block">
    <img class="gl-img" src="https://cdn.shopify.com/s/files/1/2271/6167/files/PORTRAIT-CANVAS-SIZES.webp?v=1756237261" alt="Portrait / Landscape canvas size illustration" loading="lazy">
    <div class="gl-head">
      <h2>Portrait / Landscape</h2>
      <div class="gl-tabs" role="tablist" aria-label="Units">
        <button class="gl-tab is-active" data-unit="cm" aria-selected="true">cm</button>
        <button class="gl-tab" data-unit="inch" aria-selected="false">inches</button>
      </div>
    </div>
    <table class="gl-table" aria-live="polite">
      <thead>
        <tr><th>Size</th><th>Canvas Size</th><th>Framed Size</th></tr>
      </thead>
      <tbody>
        <tr><td>Small</td><td class="gl-val" data-cm="30 x 41" data-inch="12 x 16">30 x 41 cm</td><td class="gl-val" data-cm="34 x 45" data-inch="13.4 x 17.4">34 x 45 cm</td></tr>
        <tr><td>Medium</td><td class="gl-val" data-cm="51 x 71" data-inch="20 x 28">51 x 71 cm</td><td class="gl-val" data-cm="55 x 75" data-inch="21.4 x 29.4">55 x 75 cm</td></tr>
        <tr><td>Large</td><td class="gl-val" data-cm="71 x 102" data-inch="28 x 40">71 x 102 cm</td><td class="gl-val" data-cm="75 x 106" data-inch="29.4 x 41.4">75 x 106 cm</td></tr>
        <tr><td>Extra Large</td><td class="gl-val" data-cm="91 x 127" data-inch="36 x 50">91 x 127 cm</td><td class="gl-val" data-cm="95 x 131" data-inch="37.4 x 51.4">95 x 131 cm</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Square -->
  <div class="gl-block">
    <img class="gl-img" src="https://cdn.shopify.com/s/files/1/2271/6167/files/SQUARE-CANVAS-SIZES-SCALE.webp?v=1756238387" alt="Square canvas size illustration" loading="lazy">
    <div class="gl-head">
      <h2>Square</h2>
      <div class="gl-tabs" role="tablist" aria-label="Units">
        <button class="gl-tab is-active" data-unit="cm" aria-selected="true">cm</button>
        <button class="gl-tab" data-unit="inch" aria-selected="false">inches</button>
      </div>
    </div>
    <table class="gl-table" aria-live="polite">
      <thead>
        <tr><th>Size</th><th>Canvas Size</th><th>Framed Size</th></tr>
      </thead>
      <tbody>
        <tr><td>Medium</td><td class="gl-val" data-cm="61 x 61" data-inch="24 x 24">61 x 61 cm</td><td class="gl-val" data-cm="65 x 65" data-inch="25.4 x 25.4">65 x 65 cm</td></tr>
        <tr><td>Large</td><td class="gl-val" data-cm="81 x 81" data-inch="32 x 32">81 x 81 cm</td><td class="gl-val" data-cm="85 x 85" data-inch="33.4 x 33.4">85 x 85 cm</td></tr>
        <tr><td>Extra Large</td><td class="gl-val" data-cm="102 x 102" data-inch="40 x 40">102 x 102 cm</td><td class="gl-val" data-cm="106 x 106" data-inch="41.4 x 41.4">106 x 106 cm</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Frame details -->
  <div class="gl-frame">
    <div class="gl-frame-grid">
      <img class="gl-img" src="https://cdn.shopify.com/s/files/1/2271/6167/files/FRAME-DETAILS.webp?v=1756239651" alt="Frame details diagram" loading="lazy">
      <div>
        <div class="gl-head">
          <h2>Frame details</h2>
          <div class="gl-tabs" role="tablist" aria-label="Units">
            <button class="gl-tab is-active" data-unit="cm" aria-selected="true">cm</button>
            <button class="gl-tab" data-unit="inch" aria-selected="false">inches</button>
          </div>
        </div>
        <table class="gl-table gl-tight">
          <colgroup><col class="gl-col-left"><col class="gl-col-right"></colgroup>
          <tbody>
            <tr><td class="gl-left">A&nbsp;–&nbsp;Float</td><td class="gl-val gl-right gl-single" data-cm="0.5" data-inch="0.20">0.5 cm</td></tr>
            <tr><td class="gl-left">B&nbsp;–&nbsp;Frame&nbsp;width</td><td class="gl-val gl-right gl-single" data-cm="1.2" data-inch="0.47">1.2 cm</td></tr>
            <tr><td class="gl-left">C&nbsp;–&nbsp;Frame&nbsp;depth</td><td class="gl-val gl-right gl-single" data-cm="5.4" data-inch="2.13">5.4 cm</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div> {% endcomment %}

{% schema %}
{
  "name": "Size Chart",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Title",
      "default": "Size Chart"
    }
  ],
  "blocks": [
    {
      "type": "size_details",
      "name": "Size details",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Tab title",
          "default": "Size details"
        },
        {
          "type": "header",
          "content": "Dynamic content from product"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Dynamic image for size chart"
        },
        {
          "type": "page",
          "id": "content",
          "label": "Dynamic page for size chart content"
        },
        {
          "type": "header",
          "content": "Default settings for Portrait / Landscape charts"
        },
        {
          "type": "image_picker",
          "id": "portrait_image",
          "label": "Portrait / Landscape Image"
        },
        {
          "type": "page",
          "id": "page_portrait",
          "label": "Default page for fallback content",
          "info": "If the size chart content or product orientation is not set in the product, the content from this page will be used as a fallback."
        },
        {
          "type": "header",
          "content": "Default settings for Square charts"
        },
        {
          "type": "image_picker",
          "id": "square_image",
          "label": "Square Image"
        },
        {
          "type": "page",
          "id": "page_square",
          "label": "Default page for fallback content",
          "info": "If the size chart content or product orientation is not set in the product, the content from this page will be used as a fallback."
        }
      ]
    },
    {
      "type": "size_guide",
      "name": "Size guide",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Tab title",
          "default": "How to choose your size"
        },
        {
          "type": "page",
          "id": "content",
          "label": "Page"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Size Chart",
      "category": "Product"
    }
  ]
}
{% endschema %}